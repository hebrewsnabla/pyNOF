#INFO: **** input file is /share/home/srwang/pyNOF/examples/02-N2.py ****
import sys
sys.path.append("..")
import nof
from automr import guess, dump_mat
from automr.autocas import get_uno
from pyscf import lib
lib.num_threads(4)

#mf = guess.from_fch_noiter('h4init.fch')
xyz = '''N 0.0 0.0 0.0; N 0.0 0.0 2.0'''
bas = 'def2-svp'
mf = guess.mix(xyz, bas, conv='tight')

mf, unos, noon, nacto, nelecact, ncore, _ = get_uno(mf, thresh=1.98)
dump_mat.dump_mo(mf.mol, mf.mo_coeff)

thenof = nof.SOPNOF(mf, nacto, nelecact)
thenof.verbose = 5
thenof.mo_occ = noon / 2
thenof.fcisolver = nof.fakeFCISolver()
thenof.fcisolver.ncore = ncore
thenof.fcisolver.npair = nacto//2
thenof.internal_rotation = True
thenof.mc2step()
dump_mat.dump_mo(thenof.mol, thenof.mo_coeff)







#INFO: ******************** input file end ********************


System: uname_result(system='Linux', node='xn01', release='3.10.0-1127.el7.x86_64', version='#1 SMP Tue Feb 18 16:39:12 EST 2020', machine='x86_64', processor='x86_64')  Threads 4
Python 3.7.4 (default, Aug 13 2019, 20:35:49) 
[GCC 7.3.0]
numpy 1.17.2  scipy 1.4.1
Date: Thu Feb 24 16:55:27 2022
PySCF version 1.7.6a1
PySCF path  /share/home/srwang/pyscf/pyscf
GIT ORIG_HEAD 80f71dfe77ac5f9caae26788acf76446987635bd
GIT HEAD      ref: refs/heads/master
GIT master branch  80f71dfe77ac5f9caae26788acf76446987635bd

[ENV] PYSCF_EXT_PATH /share/home/srwang/dh:/share/home/srwang/pyscf_ext/pyscf-tblis:/share/home/srwang/pyscf_ext/dftd3:/share/home/srwang/pyscf_ext/fciqmc:
[CONFIG] conf_file /share/home/srwang/.pyscf_conf.py
[INPUT] verbose = 4
[INPUT] num. atoms = 2
[INPUT] num. electrons = 14
[INPUT] charge = 0
[INPUT] spin (= nelec alpha-beta = 2S) = 0
[INPUT] symmetry False subgroup None
[INPUT] Mole.unit = angstrom
[INPUT]  1 N      0.000000000000   0.000000000000   0.000000000000 AA    0.000000000000   0.000000000000   0.000000000000 Bohr
[INPUT]  2 N      0.000000000000   0.000000000000   2.000000000000 AA    0.000000000000   0.000000000000   3.779452249130 Bohr

nuclear repulsion = 12.96484166754
number of shells = 12
number of NR pGTOs = 48
number of NR cGTOs = 28
basis = def2-svp
ecp = {}
CPU time:         1.09


******** <class 'pyscf.scf.hf.RHF'> ********
method = RHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-05
SCF conv_tol_grad = None
SCF max_cycles = 50
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyNOF/examples/tmpo2d4kofz
max_memory 4000 MB (current use 104 MB)
Set gradient conv threshold to 0.00316228
init E= -107.538553781823
  HOMO = -0.210564143854501  LUMO = -0.116900484433163
cycle= 1 E= -108.193931811614  delta_E= -0.655  |g|= 0.274  |ddm|= 1.57
  HOMO = -0.444063814299107  LUMO = -0.131580341369522
cycle= 2 E= -108.21306958314  delta_E= -0.0191  |g|= 0.0636  |ddm|= 0.372
  HOMO = -0.404011256448584  LUMO = -0.087720215100699
cycle= 3 E= -108.214382159788  delta_E= -0.00131  |g|= 0.0151  |ddm|= 0.0646
  HOMO = -0.406400777863572  LUMO = -0.0895304845834828
cycle= 4 E= -108.214505136941  delta_E= -0.000123  |g|= 0.00125  |ddm|= 0.028
  HOMO = -0.40637353882065  LUMO = -0.0894699274714044
cycle= 5 E= -108.214505713046  delta_E= -5.76e-07  |g|= 0.000213  |ddm|= 0.00183
  HOMO = -0.406432755416075  LUMO = -0.0895348506036205
Extra cycle  E= -108.214505730184  delta_E= -1.71e-08  |g|= 5.67e-05  |ddm|= 0.00034
converged SCF energy = -108.214505730184
**** generating mix guess ****
rotating angle: 0.25 pi


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyNOF/examples/tmpp48pa5p5
max_memory 4000 MB (current use 120 MB)
number electrons alpha = 7  beta = 7
Set gradient conv threshold to 3.16228e-05
init E= -127.116193118672
  alpha nocc = 7  HOMO = 4.93167253940785  LUMO = 4.95701187942335
  beta  nocc = 7  HOMO = 4.93167253940694  LUMO = 4.95701187942438
cycle= 1 E= -101.139105216767  delta_E=   26  |g|= 3.09  |ddm|= 5.99
  alpha nocc = 7  HOMO = -1.20822668858808  LUMO = -1.1656042417604
  beta  nocc = 7  HOMO = -1.20822668858635  LUMO = -1.16560424174441
cycle= 2 E= -107.739964606954  delta_E= -6.6  |g|=  1.1  |ddm|= 4.88
  alpha nocc = 7  HOMO = -0.423725708000107  LUMO = -0.0373516293683641
  beta  nocc = 7  HOMO = -0.42372570801212  LUMO = -0.037351629774372
cycle= 3 E= -108.459136326175  delta_E= -0.719  |g|= 0.189  |ddm|= 1.07
  alpha nocc = 7  HOMO = -0.441541455864896  LUMO = 0.0681405483608649
  beta  nocc = 7  HOMO = -0.441541455835711  LUMO = 0.0681405483307812
cycle= 4 E= -108.492491548159  delta_E= -0.0334  |g|= 0.0539  |ddm|= 0.206
  alpha nocc = 7  HOMO = -0.436781491885889  LUMO = 0.0767606124986328
  beta  nocc = 7  HOMO = -0.436781491956742  LUMO = 0.0767606125724115
cycle= 5 E= -108.499120424843  delta_E= -0.00663  |g|= 0.0254  |ddm|= 0.101
  alpha nocc = 7  HOMO = -0.435250203056725  LUMO = 0.081594489322824
  beta  nocc = 7  HOMO = -0.435250202795427  LUMO = 0.0815944890565882
cycle= 6 E= -108.501888225076  delta_E= -0.00277  |g|= 0.0127  |ddm|= 0.0763
  alpha nocc = 7  HOMO = -0.436421257043737  LUMO = 0.0794529668058559
  beta  nocc = 7  HOMO = -0.436421257965563  LUMO = 0.079452967746024
cycle= 7 E= -108.502722337468  delta_E= -0.000834  |g|= 0.00583  |ddm|= 0.0579
  alpha nocc = 7  HOMO = -0.436010643870005  LUMO = 0.0796548500765203
  beta  nocc = 7  HOMO = -0.436010643598957  LUMO = 0.079654849744574
cycle= 8 E= -108.502805231979  delta_E= -8.29e-05  |g|= 0.00669  |ddm|= 0.00768
  alpha nocc = 7  HOMO = -0.435410955615354  LUMO = 0.0795160393867409
  beta  nocc = 7  HOMO = -0.435410952495242  LUMO = 0.0795160355065702
cycle= 9 E= -108.502612039074  delta_E= 0.000193  |g|= 0.00267  |ddm|= 0.025
  alpha nocc = 7  HOMO = -0.435653703030108  LUMO = 0.0795712573089275
  beta  nocc = 7  HOMO = -0.435653704611225  LUMO = 0.0795712593959475
cycle= 10 E= -108.50259042368  delta_E= 2.16e-05  |g|= 0.000266  |ddm|= 0.0132
  alpha nocc = 7  HOMO = -0.435602958537844  LUMO = 0.0795641195517202
  beta  nocc = 7  HOMO = -0.435602958052915  LUMO = 0.0795641190674568
cycle= 11 E= -108.502590506661  delta_E= -8.3e-08  |g|= 3.44e-05  |ddm|= 0.00056
  alpha nocc = 7  HOMO = -0.435636353680784  LUMO = 0.0795668471651296
  beta  nocc = 7  HOMO = -0.435636353662598  LUMO = 0.0795668471594468
cycle= 12 E= -108.502590507678  delta_E= -1.02e-09  |g|= 8.94e-06  |ddm|= 5.24e-05
  alpha nocc = 7  HOMO = -0.435638119457527  LUMO = 0.0795672742297071
  beta  nocc = 7  HOMO = -0.435638119465624  LUMO = 0.0795672742390921
cycle= 13 E= -108.502590507761  delta_E= -8.24e-11  |g|= 1.86e-06  |ddm|= 1.91e-05
  alpha nocc = 7  HOMO = -0.435638353995567  LUMO = 0.0795666477017331
  beta  nocc = 7  HOMO = -0.43563835399933  LUMO = 0.0795666477051287
Extra cycle  E= -108.502590507764  delta_E= -3.91e-12  |g|= 1.06e-06  |ddm|= 2.58e-06
converged SCF energy = -108.502590507764  <S^2> = 1.9573078  2S+1 = 2.9714022
**** checking UHF/UKS internal stability ...
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.34  e= [1.679153]  max|de|= 1.68  lindep= 0.722
davidson 1 2  |r|= 0.853  e= [0.514751]  max|de|= -1.16  lindep= 0.93
davidson 2 3  |r|= 0.635  e= [-0.125082]  max|de|= -0.64  lindep= 0.953
davidson 3 4  |r|= 0.328  e= [-0.306382]  max|de|= -0.181  lindep= 0.99
davidson 4 5  |r|= 0.139  e= [-0.349424]  max|de|= -0.043  lindep= 0.957
davidson 5 6  |r|= 0.0343  e= [-0.354778]  max|de|= -0.00535  lindep= 0.984
davidson 6 7  |r|= 0.0112  e= [-0.35518]  max|de|= -0.000402  lindep= 0.956
root 0 converged  |r|= 0.00328  e= -0.3552127819602502  max|de|= -3.3e-05
converged 7 8  |r|= 0.00328  e= [-0.355213]  max|de|= -3.3e-05
UHF/UKS wavefunction has an internal instability.


******** <class 'pyscf.scf.uhf.UHF'> ********
method = UHF
initial guess = minao
damping factor = 0
level_shift factor = 0
DIIS = <class 'pyscf.scf.diis.CDIIS'>
diis_start_cycle = 1
diis_space = 8
SCF conv_tol = 1e-09
SCF conv_tol_grad = None
SCF max_cycles = 100
direct_scf = True
direct_scf_tol = 1e-13
chkfile to save SCF result = /share/home/srwang/pyNOF/examples/tmpp48pa5p5
max_memory 4000 MB (current use 122 MB)
number electrons alpha = 7  beta = 7
Set gradient conv threshold to 3.16228e-05
init E= -108.502216004335
  alpha nocc = 7  HOMO = -0.511647904262291  LUMO = 0.111097463844651
  beta  nocc = 7  HOMO = -0.511612500002899  LUMO = 0.111081558046032
cycle= 1 E= -108.54032225584  delta_E= -0.0381  |g|= 0.0552  |ddm|= 0.209
  alpha nocc = 7  HOMO = -0.517776389959347  LUMO = 0.102794666732532
  beta  nocc = 7  HOMO = -0.517777499303311  LUMO = 0.102805991419726
cycle= 2 E= -108.544607772897  delta_E= -0.00429  |g|= 0.0236  |ddm|= 0.0687
  alpha nocc = 7  HOMO = -0.517683763244557  LUMO = 0.10315701013338
  beta  nocc = 7  HOMO = -0.517678226004597  LUMO = 0.10315328977021
cycle= 3 E= -108.545880952173  delta_E= -0.00127  |g|= 0.00762  |ddm|= 0.0534
  alpha nocc = 7  HOMO = -0.52075708850501  LUMO = 0.101465688810689
  beta  nocc = 7  HOMO = -0.520762898333498  LUMO = 0.101470823656704
cycle= 4 E= -108.546010057512  delta_E= -0.000129  |g|= 0.00189  |ddm|= 0.0216
  alpha nocc = 7  HOMO = -0.520436715172413  LUMO = 0.102347924104253
  beta  nocc = 7  HOMO = -0.520434311750265  LUMO = 0.102345323623451
cycle= 5 E= -108.546015700033  delta_E= -5.64e-06  |g|= 0.00059  |ddm|= 0.00415
  alpha nocc = 7  HOMO = -0.520820164865034  LUMO = 0.102155572998997
  beta  nocc = 7  HOMO = -0.520821800552821  LUMO = 0.102157151689932
cycle= 6 E= -108.5460162899  delta_E= -5.9e-07  |g|= 0.000168  |ddm|= 0.00137
  alpha nocc = 7  HOMO = -0.520861971098405  LUMO = 0.102160320700251
  beta  nocc = 7  HOMO = -0.520860766090637  LUMO = 0.102159234530038
cycle= 7 E= -108.546016338639  delta_E= -4.87e-08  |g|= 4.25e-05  |ddm|= 0.000538
  alpha nocc = 7  HOMO = -0.520857888421084  LUMO = 0.102149296058477
  beta  nocc = 7  HOMO = -0.520858467015105  LUMO = 0.102149937900482
cycle= 8 E= -108.546016342582  delta_E= -3.94e-09  |g|= 2.79e-05  |ddm|= 9.52e-05
  alpha nocc = 7  HOMO = -0.520855712391404  LUMO = 0.102149892383794
  beta  nocc = 7  HOMO = -0.520855072727806  LUMO = 0.102149345641878
cycle= 9 E= -108.54601634564  delta_E= -3.06e-09  |g|= 2.6e-05  |ddm|= 6.17e-05
  alpha nocc = 7  HOMO = -0.520853796635966  LUMO = 0.10214765364694
  beta  nocc = 7  HOMO = -0.520854844509272  LUMO = 0.102148710817182
cycle= 10 E= -108.546016351864  delta_E= -6.22e-09  |g|= 2.43e-05  |ddm|= 0.000131
  alpha nocc = 7  HOMO = -0.520854644198348  LUMO = 0.102150395482902
  beta  nocc = 7  HOMO = -0.52085125582979  LUMO = 0.102147088051013
cycle= 11 E= -108.54601637127  delta_E= -1.94e-08  |g|= 1.87e-05  |ddm|= 0.000495
  alpha nocc = 7  HOMO = -0.520853261545944  LUMO = 0.102147530579146
  beta  nocc = 7  HOMO = -0.520856397751114  LUMO = 0.102150496850218
cycle= 12 E= -108.546016384205  delta_E= -1.29e-08  |g|= 1.44e-05  |ddm|= 0.000495
  alpha nocc = 7  HOMO = -0.520856339943996  LUMO = 0.102149947240955
  beta  nocc = 7  HOMO = -0.520855084457274  LUMO = 0.102148702491954
cycle= 13 E= -108.546016387506  delta_E= -3.3e-09  |g|= 1.3e-05  |ddm|= 0.000171
  alpha nocc = 7  HOMO = -0.520854464027586  LUMO = 0.102149776171413
  beta  nocc = 7  HOMO = -0.520855582685604  LUMO = 0.10215085757001
cycle= 14 E= -108.5460163913  delta_E= -3.79e-09  |g|= 1.03e-05  |ddm|= 0.000211
  alpha nocc = 7  HOMO = -0.520856582145024  LUMO = 0.102148447210399
  beta  nocc = 7  HOMO = -0.520856373069777  LUMO = 0.102148235442777
cycle= 15 E= -108.546016395655  delta_E= -4.36e-09  |g|= 4.1e-06  |ddm|= 0.000412
  alpha nocc = 7  HOMO = -0.520854917235486  LUMO = 0.102149759230865
  beta  nocc = 7  HOMO = -0.520854905381152  LUMO = 0.102149757872947
cycle= 16 E= -108.546016396129  delta_E= -4.74e-10  |g|= 1.5e-06  |ddm|= 0.00016
  alpha nocc = 7  HOMO = -0.52085530987058  LUMO = 0.102149425001533
  beta  nocc = 7  HOMO = -0.520855309337508  LUMO = 0.102149425978717
Extra cycle  E= -108.546016396134  delta_E= -5.12e-12  |g|= 1.12e-06  |ddm|= 2.02e-06
converged SCF energy = -108.546016396134  <S^2> = 2.6850806  2S+1 = 3.4264154
**** checking UHF/UKS internal stability ...
tol 0.0001  toloose 0.01
max_cycle 50  max_space 12  max_memory 2000  incore True
davidson 0 1  |r|= 2.34  e= [1.99605]  max|de|=    2  lindep= 0.994
davidson 1 2  |r|= 0.673  e= [1.220542]  max|de|= -0.776  lindep= 0.991
davidson 2 3  |r|= 0.218  e= [0.637995]  max|de|= -0.583  lindep= 0.985
davidson 3 4  |r|= 0.603  e= [0.36024]  max|de|= -0.278  lindep= 0.91
davidson 4 5  |r|= 0.231  e= [0.14193]  max|de|= -0.218  lindep= 0.947
davidson 5 6  |r|= 0.201  e= [0.082447]  max|de|= -0.0595  lindep= 0.956
davidson 6 7  |r|= 0.125  e= [0.056825]  max|de|= -0.0256  lindep= 0.987
davidson 7 8  |r|= 0.0753  e= [0.047411]  max|de|= -0.00941  lindep= 0.964
davidson 8 9  |r|= 0.14  e= [0.038666]  max|de|= -0.00875  lindep= 0.878
davidson 9 10  |r|= 0.0841  e= [0.023013]  max|de|= -0.0157  lindep= 0.967
davidson 10 11  |r|= 0.0368  e= [0.020154]  max|de|= -0.00286  lindep= 0.925
davidson 11 12  |r|= 0.0207  e= [0.019522]  max|de|= -0.000632  lindep= 0.922
davidson 12 1  |r|= 0.0207  e= [0.019522]  max|de|= -7.81e-16  lindep=    1
davidson 13 2  |r|= 0.0238  e= [0.019252]  max|de|= -0.00027  lindep= 0.864
davidson 14 3  |r|= 0.0472  e= [0.018227]  max|de|= -0.00103  lindep= 0.958
davidson 15 4  |r|= 0.107  e= [0.009871]  max|de|= -0.00836  lindep= 0.948
davidson 16 5  |r|= 0.06  e= [0.002723]  max|de|= -0.00715  lindep= 0.941
davidson 17 6  |r|= 0.0281  e= [0.000812]  max|de|= -0.00191  lindep= 0.967
davidson 18 7  |r|= 0.0157  e= [0.000373]  max|de|= -0.000439  lindep= 0.956
davidson 19 8  |r|= 0.0092  e= [0.000236]  max|de|= -0.000137  lindep= 0.906
davidson 20 9  |r|= 0.0109  e= [0.00007]  max|de|= -0.000166  lindep= 0.978
root 0 converged  |r|= 0.00446  e= 1.5705585731901606e-05  max|de|= -5.43e-05
converged 21 10  |r|= 0.00446  e= [0.000016]  max|de|= -5.43e-05
UHF/UKS wavefunction is stable in the internal stability analysis
time for guess: 0.306
UNO ON: [ 2.        2.        1.99585   1.9955    1.523443  1.182266  1.158011  0.841989  0.817734  0.476557  0.0045    0.00415   0.        0.        0.
  0.        0.       -0.       -0.       -0.       -0.       -0.       -0.       -0.       -0.       -0.       -0.       -0.      ]
nacto, nacta, nactb: 6 3 3
Converting <class 'pyscf.scf.uhf.UHF'> to RHF
UNO in active space
             #0      #1      #2      #3      #4      #5     
  0 N 2s                                               0.108
  0 N 3s                                               0.126
  0 N 2px              0.365   0.265   0.290  -0.400        
  0 N 2py              0.259  -0.373  -0.408  -0.284        
  0 N 2pz      0.437                                  -0.548
  0 N 3px             -0.269  -0.185  -0.194   0.284        
  0 N 3py             -0.191   0.261   0.273   0.202        
  0 N 3pz     -0.304                                   0.389
  1 N 2s                                              -0.108
  1 N 3s                                              -0.126
  1 N 2px              0.365   0.265  -0.290   0.400        
  1 N 2py              0.259  -0.373   0.408   0.284        
  1 N 2pz     -0.437                                  -0.548
  1 N 3px             -0.269  -0.185   0.194  -0.284        
  1 N 3py             -0.191   0.261  -0.273  -0.202        
  1 N 3pz      0.304                                   0.389
             #0      #1      #2      #3      #4      #5     
  0 N 1s      -0.708   0.708   0.187  -0.200                
  0 N 2s                       0.448  -0.480                
  0 N 3s                       0.287  -0.335                
  0 N 2px                                              0.365
  0 N 2py                                              0.259
  0 N 2pz                                      0.437        
  0 N 3px                                             -0.269
  0 N 3py                                             -0.191
  0 N 3pz                                     -0.304        
  1 N 1s       0.708   0.708   0.187   0.200                
  1 N 2s                       0.448   0.480                
  1 N 3s                       0.287   0.335                
  1 N 2px                                              0.365
  1 N 2py                                              0.259
  1 N 2pz                                     -0.437        
  1 N 3px                                             -0.269
  1 N 3py                                             -0.191
  1 N 3pz                                      0.304        
             #6      #7      #8      #9      #10     #11    
  0 N 2s                               0.108  -0.274   0.385
  0 N 3s                               0.126   0.263  -0.542
  0 N 2px      0.265   0.290  -0.400                        
  0 N 2py     -0.373  -0.408  -0.284                        
  0 N 2pz                             -0.548          -0.112
  0 N 3px     -0.185  -0.194   0.284                        
  0 N 3py      0.261   0.273   0.202                        
  0 N 3pz                              0.389          -0.298
  0 N 3dxy                                     0.570  -0.557
  0 N 3dz^2                                   -0.320   0.290
 0 N 3dx2-y2                                   0.199  -0.194
  1 N 2s                              -0.108  -0.274  -0.385
  1 N 3s                              -0.126   0.263   0.542
  1 N 2px      0.265  -0.290   0.400                        
  1 N 2py     -0.373   0.408   0.284                        
  1 N 2pz                             -0.548          -0.112
  1 N 3px     -0.185   0.194  -0.284                        
  1 N 3py      0.261  -0.273  -0.202                        
  1 N 3pz                              0.389          -0.298
  1 N 3dxy                                     0.570   0.557
  1 N 3dz^2                                   -0.320  -0.290
 1 N 3dx2-y2                                   0.199   0.194
             #12     #13     #14     #15     #16     #17    
  0 N 1s               0.162                                
  0 N 2s       0.114   0.805  -0.100                        
  0 N 3s      -0.668  -0.612   0.275                        
  0 N 2px                                      0.112        
  0 N 2py                      0.106  -0.158                
  0 N 2pz     -0.648  -0.540   0.100                        
  0 N 3px                                      0.119        
  0 N 3py                      0.172  -0.272   0.130        
  0 N 3pz     -1.388  -0.432   0.304                        
  0 N 3dxy                     0.296                        
  0 N 3dz^2   -0.136  -0.120   0.612                        
  0 N 3dxz                             0.112                
  1 N 1s               0.162   0.131                        
  1 N 2s      -0.114   0.805   0.782   0.274                
  1 N 3s       0.668  -0.612  -0.950  -0.251                
  1 N 2py                     -0.333   0.606  -0.396        
  1 N 2pz     -0.648   0.540                                
  1 N 3py                     -0.399   0.718  -0.464        
  1 N 3pz     -1.388   0.432   0.139                        
  1 N 3dxy                     0.203   0.410   0.353        
  1 N 3dyz                             0.108  -0.270        
  1 N 3dz^2    0.136  -0.120   0.246   0.579   0.178        
  1 N 3dxz                                    -0.136  -0.991
 1 N 3dx2-y2                   0.320          -0.744   0.120
             #18     #19     #20     #21     #22     #23    
  0 N 1s              -0.252                                
  0 N 2s              -1.485   0.120                        
  0 N 3s               1.842  -0.272                  -0.186
  0 N 2px                                     -0.874  -0.180
  0 N 2py                      0.134                   0.146
  0 N 2pz             -0.284                          -0.187
  0 N 3px                      0.100          -0.993  -0.217
  0 N 3py                      0.217                   0.191
  0 N 3pz              0.117  -0.289          -0.166  -0.346
  0 N 3dxy            -0.254  -0.134           0.156  -0.238
  0 N 3dz^2            0.103  -0.500   0.150                
  0 N 3dxz                     0.247   0.963                
 0 N 3dx2-y2                  -0.332          -0.301   0.795
  1 N 2s               0.535  -0.338          -0.271  -0.535
  1 N 3s              -0.860   0.496           0.328   0.665
  1 N 2py     -0.172          -0.383                  -0.142
  1 N 2pz              0.301                           0.177
  1 N 3px                                      0.134   0.113
  1 N 3py     -0.200          -0.459                  -0.189
  1 N 3pz              0.731  -0.154                        
  1 N 3dyz     0.952                                        
  1 N 3dz^2           -0.124   0.479  -0.194           0.255
 1 N 3dx2-y2  -0.240           0.408                        
             #24     #25     #26     #27    
  0 N 3s              -0.190                
  0 N 2px              0.268  -0.189        
  0 N 2py             -0.523  -0.756        
  0 N 2pz             -0.291   0.154        
  0 N 3px     -0.111   0.323  -0.238        
  0 N 3py             -0.596  -0.816        
  0 N 3pz             -0.466   0.236        
  0 N 3dxy             0.245  -0.180        
  0 N 3dyz    -0.992                        
  0 N 3dz^2            0.328  -0.209        
 0 N 3dx2-y2          -0.139   0.167   0.123
  1 N 1s              -0.138                
  1 N 2s              -0.781   0.412   0.145
  1 N 3s               0.929  -0.483  -0.175
  1 N 2px                      0.190  -0.942
  1 N 2py                     -0.296  -0.101
  1 N 2pz              0.290  -0.156        
  1 N 3px             -0.139   0.246  -1.055
  1 N 3py                     -0.222        
  1 N 3pz              0.163                
  1 N 3dz^2            0.202                

******** <class 'nof.SOPNOF'> ********
CAS (3e+3e, 6o), ncore = 4, nvir = 18
max_cycle_macro = 15
max_cycle_micro = 4
conv_tol = 1e-07
conv_tol_grad = None
orbital rotation max_stepsize = 1.5
augmented hessian ah_max_cycle = 30
augmented hessian ah_conv_tol = 1e-12
augmented hessian ah_linear dependence = 1e-14
augmented hessian ah_level shift = 0
augmented hessian ah_start_tol = 1e-08
augmented hessian ah_start_cycle = 3
augmented hessian ah_grad_trust_region = 1e+06
kf_trust_region = 3
kf_interval = 4
ci_response_space = 4
ci_grad_trust_region = 3
with_dep4 0
natorb = False
canonicalization = True
sorting_mo_energy = False
ao2mo_level = 2
chkfile = /share/home/srwang/pyNOF/examples/tmpp48pa5p5
max_memory 4000 MB (current use 122 MB)
internal_rotation = True
Start 2-step CASSCF

******** <class 'nof.PNOF'> ********
guess ci [0.872767 0.768852 0.760924]
cycle     maxq      dE      maxg
   0                       0.178620
   1    0.050000 -0.010979 0.116700 
Start Forming U
   2    0.050000 -0.005540 0.053639 
reset G
   3    0.009345 -0.000481 0.041782 
   4    0.032458 -0.000718 0.001175 
   5    0.003640 0.000020 0.004687 
   6    0.004859 -0.000022 0.000001 
   7    0.000001 -0.000000 0.000001 
ci [0.933141 0.81014  0.807938]
intrinsic occ [1.       1.       1.       1.       0.870752 0.656327 0.652764 0.347236 0.343673 0.129248]
PNOF5(GVB) energy -108.604552
Set conv_tol_grad to 0.000316228
    CPU time for Initializing 2-step CASSCF      1.27 sec, wall time      0.32 sec
    CPU time for update CAS DM      0.00 sec, wall time      0.00 sec
    |g|=0.0392
    CPU time for gen h_op      0.03 sec, wall time      0.01 sec
    imic 1(22)  |g[o]|=8.34e-05  |dxi|=0.0576  max(|x|)=0.0381  |dr|=0.0576  eig=-0.00145  seig=0.00113
    CPU time for aug_hess in 1 inner iters      0.21 sec, wall time      0.05 sec
    CPU time for orbital rotation      0.25 sec, wall time      0.06 sec
Active space overlap to initial guess, SVD = [0.999992 0.999983 0.999963 0.999807 0.999349 0.999252]
Active space overlap to last step, SVD = [0.999992 0.999983 0.999963 0.999807 0.999349 0.999252]
    CPU time for update eri      0.04 sec, wall time      0.01 sec
micro 0  ~dE=-0.00145  |u-1|=0.0814  |g[o]|=0.0392  |dm1|= 2.74
    CPU time for micro iter 0      0.29 sec, wall time      0.07 sec
guess ci [0.933141 0.81014  0.807938]
cycle     maxq      dE      maxg
   0                       0.011344
   1    0.005672 -0.000052 0.003893 
Start Forming U
reset G
   2    0.000738 -0.000004 0.003195 
   3    0.002089 -0.000005 0.000493 
   4    0.000376 -0.000000 0.000002 
   5    0.000001 -0.000000 0.000001 
ci [0.936209 0.810992 0.810775]
intrinsic occ [1.       1.       1.       1.       0.876487 0.657708 0.657356 0.342644 0.342292 0.123513]
PNOF5(GVB) energy -108.606063
    CPU time for CASCI solver      0.96 sec, wall time      0.24 sec
    CPU time for macro iter 1      1.25 sec, wall time      0.31 sec
    CPU time for update CAS DM      0.02 sec, wall time      0.00 sec
    |g|=0.00303
    CPU time for gen h_op      0.03 sec, wall time      0.01 sec
    imic 1(13)  |g[o]|=3.36e-07  |dxi|=0.00352  max(|x|)=0.00207  |dr|=0.00352  eig=-7.05e-06  seig=0.00238
    CPU time for orbital rotation      0.15 sec, wall time      0.04 sec
Active space overlap to initial guess, SVD = [0.999988 0.999981 0.999961 0.999796 0.999262 0.99917 ]
Active space overlap to last step, SVD = [1.       1.       1.       1.       0.999998 0.999997]
    CPU time for update eri      0.04 sec, wall time      0.01 sec
micro 0  ~dE=-7.05e-06  |u-1|=0.00497  |g[o]|=0.00303  |dm1|=0.0211
    CPU time for micro iter 0      0.21 sec, wall time      0.05 sec
guess ci [0.936209 0.810992 0.810775]
cycle     maxq      dE      maxg
   0                       0.001325
   1    0.000663 -0.000001 0.000453 
Start Forming U
reset G
   2    0.000067 -0.000000 0.000373 
   3    0.000250 -0.000000 0.000044 
   4    0.000039 -0.000000 0.000000 
   5    0.000000 -0.000000 0.000000 
ci [0.936562 0.811053 0.811032]
intrinsic occ [1.       1.       1.       1.       0.877149 0.657808 0.657772 0.342228 0.342192 0.122851]
PNOF5(GVB) energy -108.606071
    CPU time for CASCI solver      0.98 sec, wall time      0.25 sec
    CPU time for macro iter 2      1.20 sec, wall time      0.30 sec
    CPU time for update CAS DM      0.02 sec, wall time      0.01 sec
    |g|=0.000327
    CPU time for gen h_op      0.03 sec, wall time      0.01 sec
    imic 1(9)  |g[o]|=3.69e-07  |dxi|=0.000403  max(|x|)=0.000253  |dr|=0.000403  eig=-8.57e-08  seig=9.09e-06
    CPU time for orbital rotation      0.13 sec, wall time      0.03 sec
Active space overlap to initial guess, SVD = [0.999988 0.99998  0.999961 0.999795 0.999251 0.999161]
Active space overlap to last step, SVD = [1. 1. 1. 1. 1. 1.]
    CPU time for update eri      0.04 sec, wall time      0.01 sec
micro 0  ~dE=-8.57e-08  |u-1|=0.00057  |g[o]|=0.000327  |dm1|=0.00223
    CPU time for micro iter 0      0.19 sec, wall time      0.05 sec
guess ci [0.936562 0.811053 0.811032]
cycle     maxq      dE      maxg
   0                       0.000153
   1    0.000076 -0.000000 0.000052 
Start Forming U
reset G
   2    0.000007 -0.000000 0.000043 
   3    0.000030 -0.000000 0.000004 
   4    0.000004 -0.000000 0.000000 
ci [0.936603 0.811057 0.811055]
intrinsic occ [1.       1.       1.       1.       0.877225 0.657813 0.65781  0.34219  0.342187 0.122775]
PNOF5(GVB) energy -108.606071
    CPU time for CASCI solver      0.83 sec, wall time      0.21 sec
    CPU time for macro iter 3      1.03 sec, wall time      0.26 sec
    CPU time for update CAS DM      0.02 sec, wall time      0.00 sec
set max_stepsize to 0.45
    |g|=3.72e-05
    CPU time for gen h_op      0.03 sec, wall time      0.01 sec
    imic 1(3)  |g[o]|=4.06e-07  |dxi|=4.55e-05  max(|x|)=2.89e-05  |dr|=4.55e-05  eig=-1.09e-09  seig=1.6e-07
    CPU time for orbital rotation      0.06 sec, wall time      0.02 sec
Active space overlap to initial guess, SVD = [0.999988 0.99998  0.999961 0.999795 0.99925  0.999159]
Active space overlap to last step, SVD = [1. 1. 1. 1. 1. 1.]
    CPU time for update eri      0.04 sec, wall time      0.01 sec
micro 0  ~dE=-1.09e-09  |u-1|=6.44e-05  |g[o]|=3.72e-05  |dm1|=0.000241
    CPU time for micro iter 0      0.12 sec, wall time      0.03 sec
guess ci [0.936603 0.811057 0.811055]
cycle     maxq      dE      maxg
   0                       0.000018
   1    0.000009 -0.000000 0.000006 
Start Forming U
reset G
   2    0.000001 -0.000000 0.000005 
ci [0.936606 0.811057 0.811056]
intrinsic occ [1.       1.       1.       1.       0.877231 0.657814 0.657812 0.342188 0.342186 0.122769]
PNOF5(GVB) energy -108.606071
    CPU time for CASCI solver      0.56 sec, wall time      0.14 sec
    CPU time for macro iter 4      0.69 sec, wall time      0.17 sec
2-step CASSCF converged in 4 macro (47 JK 4 micro) steps
CASSCF canonicalization
Density matrix diagonal elements [1.75445  1.315627 1.31562  0.68438  0.684373 0.24555 ]
i = 1  <i|F|i> = -15.67292392
i = 2  <i|F|i> = -15.67280919
i = 3  <i|F|i> =  -1.01181483
i = 4  <i|F|i> =  -0.89592410
i = 5  <i|F|i> =  -0.40033829
i = 6  <i|F|i> =  -0.27583834
i = 7  <i|F|i> =  -0.27583745
i = 8  <i|F|i> =  -0.12190329
i = 9  <i|F|i> =  -0.12190228
i = 10  <i|F|i> =   0.06838503
i = 11  <i|F|i> =   0.73452464
i = 12  <i|F|i> =   0.81731429
i = 13  <i|F|i> =   0.90857831
i = 14  <i|F|i> =   0.90857845
i = 15  <i|F|i> =   1.01798051
i = 16  <i|F|i> =   1.01798055
i = 17  <i|F|i> =   1.11411391
i = 18  <i|F|i> =   1.14093503
i = 19  <i|F|i> =   2.27329078
i = 20  <i|F|i> =   2.38078293
i = 21  <i|F|i> =   2.38078296
i = 22  <i|F|i> =   2.42931399
i = 23  <i|F|i> =   2.42931399
i = 24  <i|F|i> =   2.44276195
i = 25  <i|F|i> =   2.44276195
i = 26  <i|F|i> =   2.51670181
i = 27  <i|F|i> =   2.51670183
i = 28  <i|F|i> =   2.88300262
    CPU time for 2-step CASSCF      5.47 sec, wall time      1.37 sec
CASSCF energy = -108.606071335534
CASCI E = -108.606071335534  E(CI) = -108.606071335534
             #0      #1      #2      #3      #4      #5     
  0 N 1s       0.701  -0.702   0.211  -0.222                
  0 N 2s                       0.450  -0.481                
  0 N 3s                       0.289  -0.331                
  0 N 2px                                              0.370
  0 N 2py                                              0.263
  0 N 2pz                                      0.435        
  0 N 3px                                             -0.264
  0 N 3py                                             -0.188
  0 N 3pz                                     -0.306        
  1 N 1s       0.702   0.701   0.211   0.222                
  1 N 2s                       0.450   0.481                
  1 N 3s                       0.289   0.331                
  1 N 2px                                              0.370
  1 N 2py                                              0.263
  1 N 2pz                                     -0.435        
  1 N 3px                                             -0.264
  1 N 3py                                             -0.188
  1 N 3pz                                      0.306        
             #6      #7      #8      #9      #10     #11    
  0 N 1s                                       0.218  -0.184
  0 N 2s                                       1.129  -1.004
  0 N 3s                               0.135  -1.042   1.034
  0 N 2px      0.263   0.292  -0.410                        
  0 N 2py     -0.370  -0.410  -0.292                        
  0 N 2pz                             -0.568          -0.342
  0 N 3px     -0.188  -0.192   0.270                        
  0 N 3py      0.264   0.270   0.192                        
  0 N 3pz                              0.353   0.178  -0.364
  1 N 1s                                       0.218   0.184
  1 N 2s                                       1.129   1.004
  1 N 3s                              -0.135  -1.042  -1.034
  1 N 2px      0.263  -0.292   0.410                        
  1 N 2py     -0.370   0.410   0.292                        
  1 N 2pz                             -0.568          -0.342
  1 N 3px     -0.188   0.192  -0.270                        
  1 N 3py      0.264  -0.270  -0.192                        
  1 N 3pz                              0.353  -0.178  -0.364
             #12     #13     #14     #15     #16     #17    
  0 N 1s                                               0.107
  0 N 2s                                       0.227   0.835
  0 N 3s                                              -1.500
  0 N 2px      0.402  -0.557  -0.395  -0.543                
  0 N 2py     -0.557  -0.402  -0.543   0.395                
  0 N 2pz                                     -0.734  -0.522
  0 N 3px      0.395  -0.547  -0.519  -0.712                
  0 N 3py     -0.547  -0.395  -0.712   0.519                
  0 N 3pz                                     -0.663  -1.385
  1 N 1s                                              -0.107
  1 N 2s                                       0.227  -0.835
  1 N 3s                                               1.500
  1 N 2px      0.402  -0.557   0.395   0.543                
  1 N 2py     -0.557  -0.402   0.543  -0.395                
  1 N 2pz                                      0.734  -0.522
  1 N 3px      0.395  -0.547   0.519   0.712                
  1 N 3py     -0.547  -0.395   0.712  -0.519                
  1 N 3pz                                      0.663  -1.385
             #18     #19     #20     #21     #22     #23    
  0 N 3dxy                             0.163   0.688  -0.684
  0 N 3dyz             0.406  -0.575                        
  0 N 3dz^2    0.696                                        
  0 N 3dxz             0.575   0.406                        
 0 N 3dx2-y2                          -0.688   0.163   0.181
  1 N 3dxy                             0.163   0.688   0.684
  1 N 3dyz            -0.406   0.575                        
  1 N 3dz^2    0.696                                        
  1 N 3dxz            -0.575  -0.406                        
 1 N 3dx2-y2                          -0.688   0.163  -0.181
             #24     #25     #26     #27    
  0 N 2s                               0.322
  0 N 3s                              -0.645
  0 N 2pz                             -0.146
  0 N 3pz                             -0.576
  0 N 3dxy    -0.181                        
  0 N 3dyz            -0.580  -0.413        
  0 N 3dz^2                           -0.750
  0 N 3dxz             0.413  -0.580        
 0 N 3dx2-y2  -0.684                        
  1 N 2s                              -0.322
  1 N 3s                               0.645
  1 N 2pz                             -0.146
  1 N 3pz                             -0.576
  1 N 3dxy     0.181                        
  1 N 3dyz            -0.580  -0.413        
  1 N 3dz^2                            0.750
  1 N 3dxz             0.413  -0.580        
 1 N 3dx2-y2   0.684                        
